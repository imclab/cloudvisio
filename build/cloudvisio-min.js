window.Cloudvisio||function(t){var o={el:"#vis",layout:"stack",container:"svg",width:"100%",height:"100%"};Cloudvisio=function(t){t=t||{},this.el=t.el||o.el,t.layout=(t.layout||o.layout).toLowerCase(),t.container=t.container||o.container,t.width=t.width||o.width,t.height=t.height||o.height,this.options=t;var i=this["_"+t.layout]||this._stack;this.chart(i),this._container()},Cloudvisio.prototype={constructor:Cloudvisio,description:function(){return"Cloudvisio running on D3"}},Cloudvisio.prototype.chart=function(t){return arguments.length?(console.log(t),this._chart=t,this):this._chart},Cloudvisio.prototype._stack=function(){var o=960,i=500,n="country",e="population";this.models.map(function(t){return t[n]});var r=this.models.map(function(t,o){return{x:o,y:t[e]}}),a=[r],s=t.select(this.el+" "+this.options.container).append("svg:g").attr("transform","translate(10,470)");x=t.scale.ordinal().rangeRoundBands([0,o-50]),y=t.scale.linear().range([0,i-50]),z=t.scale.ordinal().range(["darkblue","blue","lightblue"]);var u=t.layout.stack()(a);x.domain(u[0].map(function(t){return t.x})),y.domain([0,t.max(u[u.length-1],function(t){return t.y0+t.y})]);var l=s.selectAll("g.valgroup").data(u).enter().append("svg:g").attr("class","valgroup").style("fill",function(t,o){return z(o)}).style("stroke",function(o,i){return t.rgb(z(i)).darker()});l.selectAll("rect").data(function(t){return t}).enter().append("svg:rect").attr("x",function(t){return x(t.x)}).attr("y",function(t){return-y(t.y0)-y(t.y)}).attr("height",function(t){return y(t.y)}).attr("width",x.rangeBand())},Cloudvisio.prototype._pie=function(){var o=0,i=100,n=0,e=t.scale.category20c(),r="country",a="population";this.models.map(function(t){return t[r]});var s=this.models.map(function(t){return t[a]}),u=[s],l=t.select(this.el+" "+this.options.container).data(u).append("svg:g").attr("transform","translate("+(i+o)+","+(i+o)+")");l.selectAll("path").data(t.layout.pie()).enter().append("svg:path").attr("d",t.svg.arc().innerRadius(n).outerRadius(i)).style("fill",function(t,o){return e(o)})},Cloudvisio.prototype.models=[],Cloudvisio.prototype.data=function(t){return arguments.length?(this._data=t,this):this._data},Cloudvisio.prototype.set=function(t){if(t=t||!1){if("undefined"!=t.length)for(var o in t)this.models.push(t[o]);else this.models.push(t);return this}},Cloudvisio.prototype.search=function(t){return RegExp(t),this},Cloudvisio.prototype._data={},Cloudvisio.prototype.process=function(t,o){console.log(t+" : "+o)},Cloudvisio.prototype.match=function(t){return RegExp(t),this},Cloudvisio.prototype.verbalize=function(){},Cloudvisio.prototype.render=function(){t.select(this.el+" "+this.options.container).data(this.models);var o=this.chart();o.call(this,arguments)},Cloudvisio.prototype.update=function(){},Cloudvisio.prototype._container=function(){t.select(this.el).append(this.options.container).attr("width",this.options.width).attr("height",this.options.height)}}(window.d3);